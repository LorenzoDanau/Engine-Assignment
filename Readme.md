This is the app ported from c# to c++